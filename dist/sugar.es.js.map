{"version":3,"file":"sugar.es.js","sources":["../packages/sugar-hook/src/hooks/onMounted.ts","../packages/sugar-compiler/src/utils.ts","../packages/sugar-compiler/src/parse.ts","../packages/sugar-compiler/src/toAst.ts","../packages/sugar-shared/src/nodeOps.ts","../packages/sugar-shared/src/index.ts","../packages/sugar-compiler/src/transform.ts","../packages/sugar-compiler/src/transform/sIf.ts","../packages/sugar-compiler/src/codegen.ts","../packages/sugar-compiler/src/transform/sFor.ts","../packages/sugar-compiler/src/transform/sHtml.ts","../packages/sugar-compiler/src/transform/sLoading.ts","../packages/sugar-compiler/src/transform/transformEvent.ts","../packages/sugar-compiler/src/transform/sModel.ts","../packages/sugar-compiler/src/compile.ts","../packages/sugar-compiler/src/index.ts","../packages/sugar-render/src/utils.ts","../packages/sugar-render/src/componentCache.ts","../packages/sugar-reactive/src/nextTick.ts","../packages/sugar-reactive/src/scheduler.ts","../packages/sugar-reactive/src/dep.ts","../packages/sugar-reactive/src/ref.ts","../packages/sugar-reactive/src/reactive.ts","../packages/sugar-reactive/src/defineProps.ts","../packages/sugar-render/src/component.ts","../packages/sugar-render/src/patch.ts","../packages/sugar-render/src/index.ts","../packages/sugar-core/src/utils/utils.ts","../packages/sugar-core/src/index.ts","../packages/sugar/src/main.ts"],"sourcesContent":["import { type MountHandleList, type MountHandler } from '../types';\n\nlet mountHandleList: MountHandleList = {};\nlet ActiveId: string = '';\n\nfunction onMounted(handle: MountHandler) {\n  if (!mountHandleList[ActiveId]) {\n    mountHandleList[ActiveId] = [];\n  }\n\n  mountHandleList[ActiveId].push({\n    used: false,\n    fun: handle,\n  });\n}\n\nfunction updateActiveId(id: string) {\n  ActiveId = id;\n}\n\nfunction clearMounted() {\n  mountHandleList = {};\n}\n\nexport { onMounted, mountHandleList, clearMounted, updateActiveId };\n","export const isArray = Array.isArray;\n\nexport const extend = Object.assign;\n\n// Âà§Êñ≠‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊòØÂê¶ÊòØÂêàÊ≥ïÁöÑÂèòÈáèÊ†áËØÜÁ¨¶Ôºà‰∏çËÉΩÂåÖÂê´Êìç‰ΩúÁ¨¶„ÄÅÁÇπ„ÄÅÊã¨Âè∑Á≠âÔºâ\nfunction isSimpleIdentifier(exp: string): boolean {\n  return /^[A-Za-z_$][\\w$]*$/.test(exp);\n}\n\n// Âà§Êñ≠Ë°®ËææÂºèÊòØÂê¶ÊòØ‚ÄúÈùôÊÄÅÁöÑ‚ÄùÔºàÂç≥ÂèØ‰ª•Âú®ÁºñËØëÊúüÁ°ÆÂÆöÁöÑÔºâ\nexport function isStaticExpression(exp: string): boolean {\n  // 1. Â¶ÇÊûúÊòØÂêàÊ≥ïÁöÑÂèòÈáèÂêçÔºöÈùôÊÄÅÔºàÂ¶Ç @click=\"handleClick\"Ôºâ\n  if (isSimpleIdentifier(exp)) {\n    return true;\n  }\n\n  // 2. Â¶ÇÊûúÂåÖÂê´ÂáΩÊï∞Ë∞ÉÁî®„ÄÅÊìç‰ΩúÁ¨¶„ÄÅÁÆ≠Â§¥ÂáΩÊï∞Á≠âÔºåËÆ§‰∏∫ÊòØÂä®ÊÄÅ\n  // ËøôÂè™ÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑÂêØÂèëÂºèÂà§Êñ≠\n  const dynamicKeywords = ['(', ')', '=>', '+', '-', '*', '/', '.', '[', ']'];\n\n  for (const keyword of dynamicKeywords) {\n    if (exp.includes(keyword)) {\n      return false;\n    }\n  }\n\n  // ÈªòËÆ§ËÆ§‰∏∫ÊòØÈùôÊÄÅ\n  return true;\n}\n","import { extend, isArray, isStaticExpression } from './utils';\n\nconst scopeStack: any[] = [];\n\nfunction enterScope(newScope: any) {\n  scopeStack.push(newScope);\n}\n\nfunction exitScope() {\n  scopeStack.pop();\n}\n\nexport function parse(context: any, ancestors: any) {\n  const parent: any = last(ancestors);\n  const nodes = [];\n  while (!isEnd(context, ancestors)) {\n    const s = context.source;\n    let node: any;\n    if (startsWith(s, context.options.delimiters[0])) {\n      node = parseInterpolation(context);\n    } else if (s[0] === '<') {\n      if (s.length === 1) {\n        // ‰ªÄ‰πàÈÉΩ‰∏çÂÅö\n      } else if (s[1] === '/') {\n        if (s[2] === '>') {\n          advanceBy(context, 3);\n          continue;\n        } else if (/[a-z]/i.test(s[2])) {\n          parseTag(context, TagType.End, parent);\n          continue;\n        } else {\n          node = parseComment(context);\n        }\n      } else if (/[a-z]/i.test(s[1])) {\n        node = parseElement(context, ancestors);\n      } else if (s[1] === '!') {\n        node = parseComment(context);\n      }\n    }\n\n    if (!node) {\n      node = parseText(context);\n    }\n\n    if (isArray(node)) {\n      for (let i = 0; i < node.length; i++) {\n        pushNode(nodes, node[i]);\n      }\n    } else {\n      pushNode(nodes, node);\n    }\n  }\n\n  let removedWhitespace = false;\n\n  const shouldCondense = context.options.whitespace !== 'preserve';\n  for (let i = 0; i < nodes.length; i++) {\n    const node = nodes[i];\n    if (node.type === NodeTypes.TEXT) {\n      if (!context.inPre) {\n        if (!/[^\\t\\r\\n\\f ]/.test(node.content)) {\n          const prev = nodes[i - 1];\n          const next = nodes[i + 1];\n          if (\n            !prev ||\n            !next ||\n            (shouldCondense &&\n              ((prev.type === NodeTypes.COMMENT && next.type === NodeTypes.COMMENT) ||\n                (prev.type === NodeTypes.COMMENT && next.type === NodeTypes.ELEMENT) ||\n                (prev.type === NodeTypes.ELEMENT && next.type === NodeTypes.COMMENT) ||\n                (prev.type === NodeTypes.ELEMENT &&\n                  next.type === NodeTypes.ELEMENT &&\n                  /[\\r\\n]/.test(node.content))))\n          ) {\n            removedWhitespace = true;\n            nodes[i] = null as any;\n          } else {\n            // Otherwise, the whitespace is condensed into a single space\n            node.content = ' ';\n          }\n        } else if (shouldCondense) {\n          // in condense mode, consecutive whitespaces in text are condensed\n          // down to a single space.\n          node.content = node.content.replace(/[\\t\\r\\n\\f ]+/g, ' ');\n        }\n      } else {\n        // #6410 normalize windows newlines in <pre>:\n        // in the DOM\n        node.content = node.content.replace(/\\r\\n/g, '\\n');\n      }\n    } else if (node.type === NodeTypes.COMMENT && !context.options.comments) {\n      removedWhitespace = true;\n      nodes[i] = null as any;\n    }\n  }\n\n  if (context.inPre && parent && context.options.isPreTag(parent.tag)) {\n    // remove leading newline per html spec\n    // https://html.spec.whatwg.org/multipage/grouping-content.html#the-pre-element\n    const first = nodes[0];\n    if (first && first.type === NodeTypes.TEXT) {\n      first.content = first.content.replace(/^\\r?\\n/, '');\n    }\n  }\n\n  return removedWhitespace ? nodes.filter(Boolean) : nodes;\n}\n\nfunction parseAttributes(context: any, type: any) {\n  const props = [];\n  const attributeNames = new Set<string>();\n  // ‚úÖ ÊèêÂâçÊ£ÄÊü•ÂΩìÂâçÊ†áÁ≠æÊòØÂê¶Âê´Êúâ s-for=\"(item,index) in xxx\"\n  const firstTagMatch = context.source\n    .slice(0, context.source.indexOf('>'))\n    .match(/s-for\\s*=\\s*[\"']\\s*\\(([^)]+)\\)\\s+in\\s+[^\"']+[\"']/);\n  if (firstTagMatch) {\n    const aliases = firstTagMatch[1].split(',').map((s) => s.trim());\n    enterScope(aliases);\n  } else if (type === 0) {\n    enterScope([]);\n  }\n\n  while (\n    context.source.length > 0 &&\n    !startsWith(context.source, '>') &&\n    !startsWith(context.source, '/>')\n  ) {\n    if (startsWith(context.source, '/')) {\n      advanceBy(context, 1);\n      advanceSpaces(context);\n      continue;\n    }\n\n    const attr = parseAttribute(context, attributeNames);\n    if (['s-if', 's-html'].includes(attr.name)) {\n      attr.value.content = bindCtx(attr.value.content);\n    }\n\n    if (attr.name === 's-for') {\n      const tar = attr.value.content.split(' in ');\n      attr.value.content = tar[0] + ' in ' + bindCtx(tar[1]);\n    }\n\n    if (attr.type === NodeTypes.ATTRIBUTE && attr.value && attr.name === 'class') {\n      attr.value.content = attr.value.content.replace(/\\s+/g, ' ').trim();\n    }\n\n    if (type === TagType.Start) {\n      props.push(attr);\n    }\n    advanceSpaces(context);\n  }\n  return props;\n}\n\nfunction parseAttribute(context: any, nameSet: any) {\n  const start = getPos(context);\n  const match = /^[^\\t\\r\\n\\f />][^\\t\\r\\n\\f />=]*/.exec(context.source)!;\n\n  const name = match[0];\n  nameSet.add(name);\n  advanceBy(context, name.length);\n  let value;\n  if (/^[\\t\\r\\n\\f ]*=/.test(context.source)) {\n    advanceSpaces(context);\n    advanceBy(context, 1);\n    advanceSpaces(context);\n    value = parseAttributeValue(context);\n  }\n\n  const loc = getSelection(context, start);\n  if (!context.inVPre && /^(v-[A-Za-z0-9-]|:|\\.|@|#)/.test(name)) {\n    const match = /(?:^v-([a-z0-9-]+))?(?:(?::|^\\.|^@|^#)(\\[[^\\]]+\\]|[^\\.]+))?(.+)?$/i.exec(name)!;\n    const isPropShorthand = startsWith(name, '.');\n    const dirName =\n      match[1] ||\n      (isPropShorthand || startsWith(name, ':')\n        ? 'bind'\n        : startsWith(name, '@') || startsWith(name, 's-on:')\n          ? 'on'\n          : 'slot');\n    let arg: { type: NodeTypes; content: string; loc: { start: any; end: any; source: any } };\n    if (match[2]) {\n      const isSlot = dirName === 'slot';\n      const startOffset = name.lastIndexOf(match[2], name.length - (match[3]?.length || 0));\n\n      const loc = getSelection(\n        context,\n        getNewPosition(context, start, startOffset),\n        getNewPosition(\n          context,\n          start,\n          startOffset + match[2].length + ((isSlot && match[3]) || '').length,\n        ),\n      );\n\n      let content = match[2];\n\n      if (content.startsWith('[')) {\n        if (!content.endsWith(']')) {\n          content = content.slice(1);\n        } else {\n          content = content.slice(1, content.length - 1);\n        }\n      } else if (isSlot) {\n        content += match[3] || '';\n      }\n\n      arg = {\n        type: NodeTypes.SIMPLE_EXPRESSION,\n        content,\n        loc,\n      };\n    }\n\n    if (value?.isQuoted) {\n      const valueLoc = value.loc;\n      valueLoc.start.offset++;\n      valueLoc.start.column++;\n      valueLoc.end = advancePosWithClone(valueLoc.start, value.content);\n      valueLoc.source = valueLoc.source.slice(1, -1);\n    }\n\n    const modifiers = match[3] ? match[3].slice(1).split('.') : [];\n    if (isPropShorthand) modifiers.push('prop');\n\n    return {\n      type: NodeTypes.DIRECTIVE,\n      name: dirName,\n      exp: value && {\n        type: NodeTypes.SIMPLE_EXPRESSION,\n        content: bindCtx(value.content),\n        loc: value.loc,\n        isStatic: !isStaticExpression(value.content),\n      },\n      arg,\n      modifiers,\n      loc,\n    };\n  }\n\n  return {\n    type: NodeTypes.ATTRIBUTE,\n    name,\n    value: value && {\n      type: NodeTypes.TEXT,\n      content: value.content,\n      loc: value.loc,\n    },\n    loc,\n  };\n}\n\nfunction getNewPosition(context: any, start: any, numberOfCharacters: number) {\n  return advancePosWithClone(\n    start,\n    context.originalSource.slice(start.offset, numberOfCharacters),\n    numberOfCharacters,\n  );\n}\n\nfunction parseAttributeValue(context: any) {\n  const start = getPos(context);\n  let content: string;\n\n  const quote = context.source[0];\n  const isQuoted = quote === '\"' || quote === \"'\";\n\n  if (isQuoted) {\n    // Quoted value.\n    advanceBy(context, 1);\n\n    const endIndex = context.source.indexOf(quote);\n    if (endIndex === -1) {\n      content = parseTextData(context, context.source.length);\n    } else {\n      content = parseTextData(context, endIndex);\n      advanceBy(context, 1);\n    }\n  } else {\n    // Unquoted\n    const match = /^[^\\t\\r\\n\\f >]+/.exec(context.source);\n    if (!match) {\n      return undefined;\n    }\n    content = parseTextData(context, match[0].length);\n  }\n\n  return {\n    content,\n    isQuoted,\n    loc: getSelection(context, start),\n  };\n}\n\nfunction pushNode(nodes: any, node: any): void {\n  if (node.type === NodeTypes.TEXT) {\n    const prev: any = last(nodes);\n    // Merge if both this and the previous node are text and those are\n    // consecutive. This happens for cases like \"a < b\".\n    if (prev && prev.type === NodeTypes.TEXT && prev.loc.end.offset === node.loc.start.offset) {\n      prev.content += node.content;\n      prev.loc.end = node.loc.end;\n      prev.loc.source += node.loc.source;\n      return;\n    }\n  }\n\n  nodes.push(node);\n}\n\nfunction parseElement(context: any, ancestors: any) {\n  const parent = last(ancestors);\n  const element: any = parseTag(context, TagType.Start, parent);\n  if (element.isSelfClosing || context.options.isVoidTag(element.tag)) {\n    return element;\n  }\n  ancestors.push(element);\n  const children = parse(context, ancestors);\n  ancestors.pop();\n  element.children = children;\n  if (startsWithEndTagOpen(context.source, element.tag)) {\n    parseTag(context, TagType.End, parent);\n  }\n  element.loc = getSelection(context, element.loc.start);\n  return element;\n}\n\nfunction parseTag(context, type, parent) {\n  const start = getPos(context);\n  const match = /^<\\/?([a-z][^\\t\\r\\n\\f />]*)/i.exec(context.source)!;\n  const tag = match[1];\n\n  advanceBy(context, match[0].length);\n  advanceSpaces(context);\n\n  const props = parseAttributes(context, type);\n\n  let isSelfClosing = false;\n\n  if (context.source.length !== 0) {\n    isSelfClosing = startsWith(context.source, '/>');\n    advanceBy(context, isSelfClosing ? 2 : 1);\n  }\n\n  if (type === TagType.End) {\n    exitScope();\n    return;\n  }\n\n  const tagType = ElementTypes.ELEMENT;\n\n  return {\n    type: NodeTypes.ELEMENT,\n    tag,\n    tagType,\n    children: [],\n    props,\n    isSelfClosing,\n    loc: getSelection(context, start),\n  };\n}\n\nconst enum TagType {\n  Start,\n  End,\n}\n\nexport const enum ElementTypes {\n  ELEMENT,\n}\n\nexport const enum Namespaces {\n  HTML,\n}\n\nfunction parseComment(context: any) {\n  const start = getPos(context);\n  const contentStart = context.source[1] === '?' ? 1 : 2;\n  let content: string;\n\n  const closeIndex = context.source.indexOf('-->') + 2;\n  if (closeIndex === -1) {\n    content = context.source.slice(contentStart);\n    advanceBy(context, context.source.length);\n  } else {\n    content = context.source.slice(contentStart, closeIndex);\n    advanceBy(context, closeIndex + 1);\n  }\n\n  return {\n    type: NodeTypes.COMMENT,\n    content,\n    loc: getSelection(context, start),\n  };\n}\n\nfunction isEnd(context, ancestors) {\n  const s = context.source;\n  if (startsWith(s, '</')) {\n    for (let i = ancestors.length - 1; i >= 0; --i) {\n      if (startsWithEndTagOpen(s, ancestors[i].tag)) {\n        return true;\n      }\n    }\n  }\n  return !s;\n}\n\nfunction parseInterpolation(context) {\n  const [open, close] = context.options.delimiters;\n  const closeIndex = context.source.indexOf(close, open.length);\n  const start = getPos(context);\n  advanceBy(context, open.length);\n  const innerStart = getPos(context);\n  const innerEnd = getPos(context);\n  const rawContentLength = closeIndex - open.length;\n  const rawContent = context.source.slice(0, rawContentLength);\n  const preTrimContent = matchText(context, rawContentLength);\n  const content = preTrimContent.trim();\n  const startOffset = preTrimContent.indexOf(content);\n  if (startOffset > 0) {\n    advancePos(innerStart, rawContent, startOffset);\n  }\n  const endOffset = rawContentLength - (preTrimContent.length - content.length - startOffset);\n  advancePos(innerEnd, rawContent, endOffset);\n  advanceBy(context, close.length);\n  return {\n    type: NodeTypes.INTERPOLATION,\n    content: {\n      type: NodeTypes.SIMPLE_EXPRESSION,\n      content: bindCtx(content),\n      loc: getSelection(context, innerStart, innerEnd),\n    },\n    loc: getSelection(context, start),\n  };\n}\n\nfunction parseText(context) {\n  const endTokens = ['<', context.options.delimiters[0]];\n  let endIndex = context.source.length;\n  for (let i = 0; i < endTokens.length; i++) {\n    const index = context.source.indexOf(endTokens[i], 1);\n    if (index !== -1 && endIndex > index) {\n      endIndex = index;\n    }\n  }\n\n  const start = getPos(context);\n  const content = parseTextData(context, endIndex);\n\n  return {\n    type: NodeTypes.TEXT,\n    content,\n    loc: getSelection(context, start),\n  };\n}\n\nfunction parseTextData(context: any, length: any) {\n  const rawText = context.source.slice(0, length);\n  advanceBy(context, length);\n  return rawText;\n}\n\nfunction getSelection(context: any, start: any, end?: any) {\n  end = end || getPos(context);\n  return {\n    start,\n    end,\n    source: context.originalSource.slice(start.offset, end.offset),\n  };\n}\n\nfunction matchText(context: any, length: any) {\n  const rawText = context.source.slice(0, length);\n  advanceBy(context, length);\n  return rawText;\n}\n\nfunction advanceBy(context: any, numberOfCharacters: number): void {\n  const { source } = context;\n  advancePos(context, source, numberOfCharacters);\n  context.source = source.slice(numberOfCharacters);\n}\n\nexport function advancePos(pos, source, numberOfCharacters = source.length) {\n  let linesCount = 0;\n  let lastNewLinePos = -1;\n  for (let i = 0; i < numberOfCharacters; i++) {\n    if (source.charCodeAt(i) === 10 /* newline char code */) {\n      linesCount++;\n      lastNewLinePos = i;\n    }\n  }\n  pos.offset += numberOfCharacters;\n  pos.line += linesCount;\n  pos.column =\n    lastNewLinePos === -1 ? pos.column + numberOfCharacters : numberOfCharacters - lastNewLinePos;\n\n  return pos;\n}\n\nfunction advancePosWithClone(pos: any, source: string, numberOfCharacters: number = source.length) {\n  return advancePos(extend({}, pos), source, numberOfCharacters);\n}\n\nfunction advanceSpaces(context: any): void {\n  const match = /^[\\t\\r\\n\\f ]+/.exec(context.source);\n  if (match) {\n    advanceBy(context, match[0].length);\n  }\n}\n\nfunction startsWith(source: string, searchString: string): boolean {\n  return source.startsWith(searchString);\n}\n\nfunction startsWithEndTagOpen(source: string, tag: string): boolean {\n  return (\n    startsWith(source, '</') &&\n    source.slice(2, 2 + tag.length).toLowerCase() === tag.toLowerCase() &&\n    /[\\t\\r\\n\\f />]/.test(source[2 + tag.length] || '>')\n  );\n}\n\nfunction last<T>(xs: T[]): T | undefined {\n  return xs[xs.length - 1];\n}\n\nfunction getPos(context) {\n  const { column, line, offset } = context;\n  return {\n    column,\n    line,\n    offset,\n  };\n}\n\nexport const enum NodeTypes {\n  ROOT,\n  ELEMENT,\n  TEXT,\n  COMMENT,\n  SIMPLE_EXPRESSION,\n  INTERPOLATION,\n  ATTRIBUTE,\n  DIRECTIVE,\n  COMPOUND_EXPRESSION,\n  COMPONENT,\n  SLOT,\n}\n\n// JavaScript ÂÜÖÁΩÆÂÖ®Â±ÄÂèòÈáèÂíåÂÖ≥ÈîÆÂ≠óÁôΩÂêçÂçï\nconst jsGlobals = new Set([\n  // ÂéüÂßãÂÄº\n  'true',\n  'false',\n  'null',\n  'undefined',\n  'NaN',\n  'Infinity',\n\n  // Âü∫Êú¨ÂØπË±°\n  'Object',\n  'Function',\n  'Boolean',\n  'Symbol',\n  'Error',\n  'EvalError',\n  'InternalError',\n  'RangeError',\n  'ReferenceError',\n  'SyntaxError',\n  'TypeError',\n  'URIError',\n\n  // Êï∞Â≠ó‰∏éÊï∞Â≠¶\n  'Number',\n  'BigInt',\n  'Math',\n  'Date',\n\n  // ÊñáÊú¨Â§ÑÁêÜ\n  'String',\n  'RegExp',\n\n  // Indexed collections\n  'Array',\n  'Int8Array',\n  'Uint8Array',\n  'Uint8ClampedArray',\n  'Int16Array',\n  'Uint16Array',\n  'Int32Array',\n  'Uint32Array',\n  'Float32Array',\n  'Float64Array',\n\n  // Keyed collections\n  'Map',\n  'Set',\n  'WeakMap',\n  'WeakSet',\n\n  // Structured data\n  'ArrayBuffer',\n  'SharedArrayBuffer',\n  'Atomics',\n  'DataView',\n  'JSON',\n\n  // Control abstraction objects\n  'Promise',\n  'Generator',\n  'GeneratorFunction',\n  'AsyncFunction',\n\n  // Reflection\n  'Reflect',\n  'Proxy',\n\n  // Web APIs & runtime globals\n  'window',\n  'globalThis',\n  'console',\n  'alert',\n  'setTimeout',\n  'setInterval',\n  'clearTimeout',\n  'clearInterval',\n  'requestAnimationFrame',\n  'cancelAnimationFrame',\n\n  // DOM\n  'document',\n  'location',\n  'history',\n  'navigator',\n\n  // Êñ∞ËØ≠Ë®ÄÂÖ≥ÈîÆÂ≠óÁ≠â\n  'await',\n  'async',\n  'arguments',\n  'this',\n]);\n\nfunction bindCtx(code: string): string {\n  return code.replace(/\\b([a-zA-Z_$][a-zA-Z0-9_$]*)\\b/g, (match, varName, offset, fullText) => {\n    // 1. Ë∑≥ËøáÂ≠óÁ¨¶‰∏≤ÂÜÖÁöÑÂèòÈáè\n    const before = fullText.slice(0, offset);\n    const inSingleQuotes = /'[^']*$/.test(before) && /[^']*'/.test(fullText.slice(offset));\n    const inDoubleQuotes = /\"[^\"]*$/.test(before) && /[^\"]*\"/.test(fullText.slice(offset));\n    const inBacktick = /`[^`]*$/.test(before) && /[^`]*`/.test(fullText.slice(offset));\n    if (inSingleQuotes || inDoubleQuotes || inBacktick) return match;\n\n    // 2. ÊéíÈô§Â±ûÊÄßËÆøÈóÆÔºå‰æãÂ¶Ç obj.key ‰∏≠ÁöÑ key\n    const prevChar = fullText[offset - 1];\n    if (prevChar === '.' || prevChar === ':') return match;\n\n    // 3. ÊéíÈô§ÂÖ®Â±Ä‰ΩúÁî®ÂüüÂèòÈáè„ÄÅJS ÂÜÖÁΩÆÂèòÈáè\n    if (hasScope(varName) || jsGlobals.has(varName)) return match;\n\n    // 4. ÈªòËÆ§Âä† _ctx_\n    return `_ctx_.${varName}`;\n  });\n}\n\nfunction flattenArray(arr: any[]): any[] {\n  const result: any[] = [];\n\n  for (const item of arr) {\n    if (Array.isArray(item)) {\n      result.push(...flattenArray(item));\n    } else {\n      result.push(item);\n    }\n  }\n\n  return result;\n}\n\nfunction hasScope(name: string): boolean {\n  return flattenArray(scopeStack).includes(name);\n}\n","import { Namespaces, parse } from './parse';\nexport const NO = (tag: string) => false;\nexport function toAst(template: string) {\n  const context = createBaseContent(template);\n  return parse(context, [])[0];\n}\n\nfunction createBaseContent(content) {\n  return {\n    column: 1,\n    line: 1,\n    offset: 0,\n    originalSource: content,\n    source: content,\n    inPre: false,\n    inVPre: false,\n    options: {\n      delimiters: ['{{', '}}'],\n      isVoidTag: NO,\n      isPreTag: NO,\n      isCustomElement: NO,\n      getNamespace: (tag: string, parent: any) => Namespaces.HTML,\n    },\n  };\n}\n","export const nodeOps = {\n  insert: (child: Element, parent: Element, anchor: Element | null) => {\n    parent.insertBefore(child, anchor || null);\n  },\n\n  remove: (child: { parentNode: any }) => {\n    const parent = child.parentNode;\n    if (parent) {\n      parent.removeChild(child);\n    }\n  },\n  parentNode: (node: { parentNode: Element | null }) => node.parentNode as Element | null,\n};\n","export const isArray = (val) => val instanceof Array;\nexport const isString = (val: unknown): val is string => typeof val === 'string';\n\nexport const enum Namespaces {\n  HTML,\n}\n\nexport const NO = (tag: string) => false;\n\nexport function startsWith(source: string, searchString: string): boolean {\n  return source.startsWith(searchString);\n}\n\nexport function startsWithEndTagOpen(source: string, tag: string): boolean {\n  return (\n    startsWith(source, '</') &&\n    source.slice(2, 2 + tag.length).toLowerCase() === tag.toLowerCase() &&\n    /[\\t\\r\\n\\f />]/.test(source[2 + tag.length] || '>')\n  );\n}\n\nexport const isIntegerKey = (key: unknown) =>\n  isString(key) && key !== 'NaN' && key[0] !== '-' && '' + parseInt(key, 10) === key;\n\nconst hasOwnProperty = Object.prototype.hasOwnProperty;\nexport const hasOwn = (val: object, key: any): key is keyof typeof val =>\n  hasOwnProperty.call(val, key);\n\nexport const hasChanged = (value: any, oldValue: any): boolean => !Object.is(value, oldValue);\n\nexport function isDef(v: any) {\n  return v !== undefined && v !== null;\n}\n\nexport function isUndef(v: any) {\n  return v === undefined || v === null;\n}\n\nexport function escape2Html(str) {\n  const arrEntities = {\n    lt: '<',\n    gt: '>',\n    nbsp: ' ',\n    amp: '&',\n    quot: '\"',\n  };\n\n  return str\n    .replace(/&(lt|gt|nbsp|amp|quot);/gi, function (all: any, t: any) {\n      return arrEntities[t];\n    })\n    .replace(/<[^>]+s-on:([^>]+)>/gi, function (match: any, p1: any) {\n      return match.replace(/s-on:/g, '@');\n    });\n}\n\nexport const enum NodeTypes {\n  ROOT,\n  ELEMENT,\n  TEXT,\n  COMMENT,\n  SIMPLE_EXPRESSION,\n  INTERPOLATION,\n  ATTRIBUTE,\n  DIRECTIVE,\n  // containers\n  COMPOUND_EXPRESSION,\n  IF,\n  IF_BRANCH,\n  FOR,\n  TEXT_CALL,\n  // codegen\n  VNODE_CALL,\n}\n\nconst is = {\n  Array: Array.isArray,\n  Date: (val) => val instanceof Date,\n  Set: (val) => Object.prototype.toString.call(val) === '[object Set]',\n  Map: (val) => Object.prototype.toString.call(val) === '[object Map]',\n  Object: (val) => Object.prototype.toString.call(val) === '[object Object]',\n  Symbol: (val) => Object.prototype.toString.call(val) === '[object Symbol]',\n  Function: (val) => Object.prototype.toString.call(val) === '[object Function]',\n};\n\nexport function deepClone(value, weakMap = new WeakMap(), strict = false) {\n  // 2.1 ÂáΩÊï∞ÊµÖÊã∑Ë¥ù\n  /* if (is.Function(value)) return value */\n\n  // 2.2 ÂáΩÊï∞Ê∑±Êã∑Ë¥ù\n  if (is.Function(value) && strict) {\n    if (/^function/.test(value.toString()) || /^\\(\\)/.test(value.toString())) {\n      return new Function('return ' + value.toString())();\n    }\n\n    return new Function('return function ' + value.toString())();\n  } else if (is.Function(value)) {\n    return value;\n  }\n\n  // 3.Date Ê∑±Êã∑Ë¥ù\n  if (is.Date(value)) return new Date(value.valueOf());\n\n  // 4.Âà§Êñ≠Â¶ÇÊûúÊòØSymbolÁöÑvalue, ÈÇ£‰πàÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑSymbol\n  if (is.Symbol(value)) return Symbol(value.description);\n\n  // 5.Âà§Êñ≠ÊòØÂê¶ÊòØSetÁ±ªÂûã ËøõË°åÊ∑±Êã∑Ë¥ù\n  if (is.Set(value)) {\n    // 5.1 ÊµÖÊã∑Ë¥ù Áõ¥Êé•ËøõË°åËß£ÊûÑÂç≥ÂèØ\n    // return new Set([...value])\n\n    // 5.2 Ê∑±Êã∑Ë¥ù\n    const newSet = new Set();\n    for (const item of value) {\n      // @ts-expect-error\n      newSet.add(deepClone(item), weakMap);\n    }\n    return newSet;\n  }\n\n  // 6.Âà§Êñ≠ÊòØÂê¶ÊòØMapÁ±ªÂûã\n  if (is.Map(value)) {\n    // 6.1 ÊµÖÊã∑Ë¥ù Áõ¥Êé•ËøõË°åËß£ÊûÑÂç≥ÂèØ\n    // return new Map([...value])\n\n    // 6.2 Ê∑±Êã∑Ë¥ù\n    const newMap = new Map();\n    for (const item of value) newMap.set(deepClone(item[0], weakMap), deepClone(item[1], weakMap));\n    return newMap;\n  }\n\n  // 9.Âà§Êñ≠weakMapÊòØÂê¶ÊúâÂÄº ÊúâÂÄºÁöÑÊÉÖÂÜµ‰∏ãÂ∞±Áõ¥Êé•Â∞ÜÂÄºËøîÂõûÂ∞±ÂèØ‰ª•\n  if (weakMap.has(value)) return weakMap.get(value);\n\n  // 11.2 Âà§Êñ≠Êï∞ÁªÑ\n  if (is.Array(value)) {\n    const newArr = [];\n    // eslint-disable-next-line @typescript-eslint/no-for-in-array\n    for (const item in value) newArr[item] = deepClone(value[item], weakMap);\n    return newArr;\n  }\n\n  // 1.Â¶ÇÊûú‰∏çÊòØÂØπË±°Á±ªÂûãÂàôÁõ¥Êé•Â∞ÜÂΩìÂâçÂÄºËøîÂõû\n  if (!is.Object(value)) return value;\n\n  // 7.Âà§Êñ≠‰º†ÂÖ•ÁöÑÂØπË±°ÊòØÊï∞ÁªÑ, ËøòÊòØÂØπË±°\n  const newObj = is.Array(value) ? [] : {};\n\n  // 10.ÂΩìweakMapÊ≤°ÊúâÂÄºÊó∂ÔºåÂ∞ÜoriginValue‰Ωú‰∏∫key, newObj‰Ωú‰∏∫value\n  weakMap.set(value, newObj);\n\n  for (const key in value) {\n    // 11.1 Âà§Êñ≠Êï∞ÁªÑ\n    if (is.Array(value[key])) deepClone(value[key], weakMap);\n\n    weakMap.set(value, newObj);\n    // 8 ËøõË°åÈÄíÂΩíË∞ÉÁî®\n    newObj[key] = deepClone(value[key], weakMap);\n  }\n\n  // 4.1 ÂØπSymbol‰Ωú‰∏∫keyËøõË°åÁâπÊÆäÁöÑÂ§ÑÁêÜ ÊãøÂà∞ÂØπË±°‰∏äÈù¢ÁöÑÊâÄÊúâSymbol keyÔºå‰ª•Êï∞ÁªÑÂΩ¢ÂºèËøîÂõû\n  const symbolKeys = Object.getOwnPropertySymbols(value);\n  for (const sKey of symbolKeys) {\n    // 4.2 ËøôÈáåÊ≤°ÊúâÂøÖË¶ÅÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑSymbol\n    // const newSKey = Symbol(sKey.description)\n\n    // 4.3 Áõ¥Êé•Â∞ÜÂéüÊù•ÁöÑSymbol key Êã∑Ë¥ùÂà∞Êñ∞ÂØπË±°‰∏äÂ∞±ÂèØ‰ª•‰∫Ü\n    newObj[sKey] = deepClone(value[sKey], weakMap);\n  }\n\n  return newObj;\n}\n\nexport function guid(): string {\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n    const r = (Math.random() * 16) | 0;\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\n    return v.toString(16);\n  });\n}\n\nexport function addCSS(cssText) {\n  const style = document.createElement('style'); // ÂàõÂª∫‰∏Ä‰∏™styleÂÖÉÁ¥†\n  const head = document.head || document.getElementsByTagName('head')[0]; // Ëé∑ÂèñheadÂÖÉÁ¥†\n  style.type = 'text/css'; // ËøôÈáåÂøÖÈ°ªÊòæÁ§∫ËÆæÁΩÆstyleÂÖÉÁ¥†ÁöÑtypeÂ±ûÊÄß‰∏∫text/cssÔºåÂê¶ÂàôÂú®ie‰∏≠‰∏çËµ∑‰ΩúÁî®\n  // @ts-expect-error\n  if (style.styleSheet) {\n    // IE\n    const func = function () {\n      try {\n        // @ts-expect-error\n        style.styleSheet.cssText = cssText;\n      } catch (e) {}\n    };\n    // @ts-expect-error\n    if (style.styleSheet.disabled) {\n      setTimeout(func, 10);\n    } else {\n      func();\n    }\n  } else {\n    // w3c\n    // w3cÊµèËßàÂô®‰∏≠Âè™Ë¶ÅÂàõÂª∫ÊñáÊú¨ËäÇÁÇπÊèíÂÖ•Âà∞styleÂÖÉÁ¥†‰∏≠Â∞±Ë°å‰∫Ü\n    const textNode = document.createTextNode(cssText);\n    style.appendChild(textNode);\n  }\n  head.appendChild(style); // ÊääÂàõÂª∫ÁöÑstyleÂÖÉÁ¥†ÊèíÂÖ•Âà∞head‰∏≠\n}\n\nexport * from './nodeOps';\n","import { NodeTypes } from './parse';\n\nexport function transform(context, helpers) {\n  function work(context) {\n    const props = context.props;\n    props?.forEach((prop) => {\n      if (prop.name === 's-if') {\n        helpers.sIf(context, prop);\n      }\n\n      if (prop.name === 's-for') {\n        helpers.sFor(context, prop);\n      }\n\n      if (prop.name === 's-html') {\n        helpers.sHtml(context, prop);\n      }\n\n      if (prop.name === 's-model') {\n        helpers.sModel(context, prop);\n      }\n\n      if (prop.name === 's-loading') {\n        helpers.sLoading(context, prop);\n      }\n\n      // if (prop.name === 'on') {\n      //   helpers.transformEvent(context, prop);\n      // }\n    });\n\n    if (context.tag === 'slot') {\n      context.type = NodeTypes.SLOT;\n    }\n\n    if (context.children) {\n      context.children.forEach((child) => {\n        work(child);\n      });\n    }\n  }\n\n  work(context);\n  return context;\n}\n","export function sIf(context, prop) {\n  context.if = {\n    value: prop.value.content,\n    type: prop.value.type,\n  };\n}\n","import { NodeTypes } from './parse';\nimport { isArray } from '@sugar/sugar-shared';\nimport { toAst } from './toAst';\nimport { transform } from './transform';\nimport { sIf } from './transform/sIf';\n\nlet key = 0;\n\nexport function generate(ast: any) {\n  const genElmChildren = (children = []) => {\n    let str = '[';\n    children.forEach((child: any, i) => {\n      if (\n        child.type === NodeTypes.ELEMENT ||\n        child.type === NodeTypes.INTERPOLATION ||\n        child.type === NodeTypes.SLOT\n      ) {\n        str += getElm(child) + `${i === children.length - 1 ? '' : ','}`;\n      } else if (child.type === NodeTypes.TEXT && !!child.content.trim()) {\n        str += getElm(child) + `${i === children.length - 1 ? '' : ','}`;\n      }\n    });\n    return str + ']';\n  };\n\n  function getElm(ast: any) {\n    let str = '';\n    const props = ast.props;\n    if (ast.type === 1 || ast.type === NodeTypes.SLOT) {\n      let elStr = '';\n      let ex = false;\n\n      elStr += `_ctx_._SUGAR._c('${ast.tag}',{ `;\n\n      elStr += '\"attrs\":{';\n\n      elStr += dealAttr(props);\n\n      elStr += '},\"on\":{';\n\n      elStr += dealEvent(props);\n\n      elStr += '}},';\n\n      if (ast.children) {\n        elStr += genElmChildren(ast.children);\n      } else {\n        elStr += '[]';\n      }\n\n      elStr += ')';\n\n      if (ast.forStatment) {\n        ex = true;\n        str += transformFor(ast);\n      }\n\n      if (ast.if && !ast.forStatment) {\n        ex = true;\n        str = `${ast.if.value} ? ${str + elStr} : _ctx_._SUGAR._e()`;\n      }\n\n      if (ast.loading && !ast.forStatment) {\n        ex = true;\n        const loadingRender = generate(\n          transform(\n            toAst(`<div class=\"s-loading\" s-if=\"${ast.loading.value}\">\n        <svg t=\"1734417183543\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4603\" width=\"30\" height=\"30\"><path d=\"M512 64c247.2 0 448 200.8 448 448h-64c0-212-172-384-384-384V64z m0 832c-212 0-384-172-384-384H64c0 247.2 200.8 448 448 448v-64z\" p-id=\"4604\" fill=\"#8a8a8a\"></path></svg>\n        </div>`),\n            {\n              sIf,\n            },\n          ),\n        );\n        str = `_ctx_._SUGAR._c('div',{attrs:{style:'position:relative'},on:{}},[${\n          str + (!ast.if ? elStr : '')\n        },${loadingRender}])`;\n      }\n\n      if (ast.htmlStatment) {\n        ex = true;\n        str = `_ctx_._SUGAR._c('div',{attrs:{${dealAttr(props)}},on:{${dealEvent(props)}}},[_ctx_._SUGAR._html(${ast.htmlStatment.value.content})])`;\n      }\n\n      if (!ex) {\n        str += elStr;\n      }\n    } else if (ast.type === NodeTypes.INTERPOLATION) {\n      str += `_ctx_._SUGAR._v(_ctx_._SUGAR._s(${ast.content.content}))`;\n    } else if (ast.type === NodeTypes.TEXT) {\n      str += `_ctx_._SUGAR._v(decodeURIComponent(\"${encodeURIComponent(ast.content)}\"))`;\n    }\n\n    return str;\n  }\n\n  return getElm(ast);\n\n  function createElementString(tag: any, props: any, children: any) {\n    let element = `_ctx_._SUGAR._c('${tag}',{`;\n    element += '\"attrs\":{';\n    element += dealAttr(props);\n    element += '},\"on\":{';\n    element += dealEvent(props);\n    element += '}},[';\n\n    children.forEach((child: any, index: any) => {\n      element += generate(child);\n      if (index < children.length - 1) {\n        element += ',';\n      }\n    });\n\n    element += '])';\n\n    // Handle s-if and s-loading directives\n    props.forEach((prop: any) => {\n      if (prop.name === 's-if') {\n        element = `${prop.value.content} ? ${element} : _ctx_._SUGAR._e()`;\n      }\n\n      if (prop.name === 's-loading' && prop.value) {\n        const loadingRender = generate(\n          transform(\n            toAst(`<div class=\"s-loading\" s-if=\"${prop.value.content}\">\n          <svg t=\"1734417183543\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"4603\" width=\"30\" height=\"30\"><path d=\"M512 64c247.2 0 448 200.8 448 448h-64c0-212-172-384-384-384V64z m0 832c-212 0-384-172-384-384H64c0 247.2 200.8 448 448 448v-64z\" p-id=\"4604\" fill=\"#8a8a8a\"></path></svg>\n        </div>`),\n            { sIf },\n          ),\n        );\n        element = `_ctx_._SUGAR._c('div',{attrs:{style:'position:relative'},on:{}},[${element},${loadingRender}])`;\n      }\n    });\n\n    return element;\n  }\n\n  function transformFor(ast: any) {\n    const forStatment = ast.forStatment;\n    const elementStr = createElementString(ast.tag, ast.props, ast.children);\n\n    return `..._ctx_._SUGAR._loop((${forStatment.item}${\n      forStatment.index ? ',' + forStatment.index : ''\n    })=>{\n      return ${elementStr}\n    },${forStatment.exp})`;\n  }\n}\n\nfunction dealAttr(props: any) {\n  let str = '';\n\n  props = props.filter((prop: any) => {\n    return (\n      prop.name !== 's-if' &&\n      prop.name !== 's-for' &&\n      prop.name !== 'on' &&\n      prop.name !== 's-loading' &&\n      prop.name !== 's-html'\n    );\n  });\n\n  props.forEach((prop: any, index: number) => {\n    if (\n      prop.name !== 's-if' &&\n      prop.name !== 's-for' &&\n      prop.name !== 'on' &&\n      prop.name !== 'bind' &&\n      prop.name !== 'slot' &&\n      prop.name !== 's-html'\n    ) {\n      str += `\"${prop.name}\":\"${prop.value.content}\"`;\n    } else if (prop.name === 'bind') {\n      str += `\"${prop.arg.content}\":${prop.exp.content}`;\n    } else if (prop.name === 'slot') {\n      str += `\"slot\":\"${prop.arg.content}\"`;\n    }\n\n    if (\n      prop.name !== 's-if' &&\n      prop.name !== 's-for' &&\n      prop.name !== 'on' &&\n      index < props.length - 1\n    ) {\n      str += ',';\n    }\n  });\n\n  return str;\n}\n\nfunction dealEvent(props: any) {\n  let str = '';\n\n  props = props.filter((prop: any) => {\n    return prop.name === 'on';\n  });\n\n  props.forEach((prop: any, index: number) => {\n    if (prop.name === 'on') {\n      let funString = `${prop.exp.content}`;\n      if (prop.exp.isStatic) {\n        funString = `(e)=>{${prop.exp.content}}`;\n      }\n      str += `\"${prop.arg.content}\":{\"value\":${funString},\"isStatic\":${prop.exp.isStatic},\"modifiers\":[${Array2String(prop.modifiers)}]}`;\n\n      if (prop.name === 'on' && index < props.length - 1) {\n        str += ',';\n      }\n    }\n  });\n\n  return str;\n}\n\nfunction Array2String(arr: any) {\n  if (!isArray(arr)) {\n    return '';\n  }\n  return arr.map((a: any) => {\n    return `\"${a}\"`;\n  });\n}\n","import { isArray } from '@sugar/sugar-shared';\n\nexport function sFor(context, prop) {\n  const forMatch = prop.value.content.split(' in ');\n  const reg = /(?<=\\()(.+?)(?=\\))/;\n  forMatch[0] = forMatch[0].match(reg) ? forMatch[0].match(reg)[0].split(',') : forMatch[0];\n\n  context.forStatment = {\n    exp: forMatch[1],\n    item: isArray(forMatch[0]) ? forMatch[0][0] : forMatch[0],\n    index: isArray(forMatch[0]) ? forMatch[0][1] : null,\n  };\n}\n","export function sHtml(context, prop) {\n  context.htmlStatment = {\n    value: prop.value,\n  };\n}\n","export function sLoading(context, prop) {\n  context.loading = {\n    value: prop.value.content,\n    type: prop.value.type,\n  };\n}\n","export function transformEvent(content, prop) {\n  if (prop.exp.content.includes('(') && prop.exp.content.includes(')')) {\n    const eventStr = prop.exp.content;\n    prop.exp.content = prop.exp.content.substring(0, eventStr.indexOf('('));\n    prop.exp.parameters = eventStr\n      .substring(eventStr.indexOf('(') + 1, eventStr.length - 1)\n      .split(',');\n  }\n}\n","export function sModel(context, prop) {\n  context.props.push({\n    type: 7,\n    name: 'on',\n    exp: {\n      type: 4,\n      content: `_ctx_.${prop.value.content} = e.target.value`,\n      isStatic: true,\n    },\n    arg: {\n      type: 4,\n      content: 'input',\n    },\n    modifiers: [],\n  });\n  context.props.push({\n    type: 7,\n    name: 'bind',\n    exp: {\n      type: 4,\n      content: `_ctx_.${prop.value.content}`,\n    },\n    arg: {\n      type: 4,\n      content: 'value',\n    },\n    modifiers: [],\n  });\n}\n","import { toAst } from './toAst';\nimport { generate } from './codegen';\nimport { transform } from './transform';\nimport { sIf } from './transform/sIf';\nimport { sFor } from './transform/sFor';\nimport { sHtml } from './transform/sHtml';\nimport { sLoading } from './transform/sLoading';\nimport { transformEvent } from './transform/transformEvent';\nimport { sModel } from './transform/sModel';\n\nexport function baseCompile(template: string) {\n  const ast = toAst(template);\n  transform(ast, {\n    sIf,\n    sFor,\n    sHtml,\n    sLoading,\n    transformEvent,\n    sModel,\n  });\n\n  return {\n    root: ast,\n    code: generate(ast),\n  };\n}\n","import { baseCompile } from './compile';\n\nexport function sugarCompiler(template: string) {\n  function compile(template = '') {\n    const { code, root } = baseCompile(template);\n    return {\n      code: createFunction(code),\n      root,\n    };\n  }\n\n  function createFunction(code = '') {\n    return new Function(`    const _ctx_ = this;\n    const proxy = new Proxy({}, {\n      get(target, prop, receiver) {\n        if (prop in ctx) {\n          return ctx[prop];\n        }\n        throw new ReferenceError(\\`Missing variable \\${String(prop)} in template\\`);\n      }\n    });\n    return ${code.toString()};\n  `);\n  }\n\n  return compile(template);\n}\n","export function isComponent(vnode: any, components: any) {\n  return !!components[vnode.tag] || vnode.tag === 'component';\n}\n","export const componentCache: any = {};\nexport function addComponentCache(sugar: any, key: any) {\n  componentCache[key] = sugar;\n}\nexport function getComponentCache(key: string) {\n  return componentCache[key];\n}\n","const callbacks = [];\nlet pending = false;\n\nfunction flushCallbacks() {\n  pending = false;\n  const copies = callbacks.slice(0);\n  callbacks.length = 0;\n  for (let i = 0; i < copies.length; i++) {\n    copies[i]();\n  }\n}\n\nexport async function nextTick(cb: Function) {\n  let _resolve;\n  callbacks.push(() => {\n    if (cb) {\n      cb();\n    } else if (_resolve) {\n      _resolve();\n    }\n  });\n  if (!pending) {\n    pending = true;\n    void Promise.resolve().then(flushCallbacks);\n  }\n\n  if (!cb) {\n    return await new Promise((resolve, reject) => {\n      // ‰øùÂ≠òresolveÂà∞callbacksÊï∞ÁªÑ‰∏≠\n      _resolve = resolve;\n    });\n  }\n}\n","const jobQueue = new Set<() => void>();\nlet isFlushing = false;\n\nexport function queueJob(job: () => void) {\n  jobQueue.add(job);\n  if (!isFlushing) {\n    isFlushing = true;\n    void Promise.resolve().then(() => {\n      for (const job of jobQueue) job();\n      jobQueue.clear();\n      isFlushing = false;\n    });\n  }\n}\n","// dep.tsÔºà‰æùËµñÊî∂ÈõÜÂô®Ôºâ\nimport { queueJob } from './scheduler';\n\ntype EffectFn = () => void;\n\nconst targetMap = new WeakMap<object, Map<string | symbol, Set<EffectFn>>>();\nlet activeEffect: EffectFn | null = null;\n\nexport function effect(fn: EffectFn) {\n  const wrapper = () => {\n    activeEffect = wrapper;\n    fn();\n    activeEffect = null;\n  };\n  wrapper();\n  return wrapper;\n}\n\nexport function track(target: object, key: string | symbol) {\n  if (!activeEffect) return;\n  let depsMap = targetMap.get(target);\n  if (!depsMap) {\n    depsMap = new Map();\n    targetMap.set(target, depsMap);\n  }\n\n  let deps = depsMap.get(key);\n  if (!deps) {\n    deps = new Set();\n    depsMap.set(key, deps);\n  }\n\n  deps.add(activeEffect);\n}\n\nexport function trigger(target: object, key: string | symbol) {\n  const depsMap = targetMap.get(target);\n  if (!depsMap) return;\n\n  const effects = depsMap.get(key);\n  if (!effects) return;\n\n  for (const effect of effects) {\n    queueJob(effect); // ÂÖ®Â±ÄË∞ÉÂ∫¶\n  }\n}\n\n// watch ÂÆûÁé∞\nfunction watch(source: any, cb: Function) {\n  // ÂÆö‰πâ‰∏Ä‰∏™ÂÜÖÈÉ®ÂâØ‰ΩúÁî®ÂáΩÊï∞ÔºåËØªÂèñsourceËß¶Âèë‰æùËµñÊî∂ÈõÜ\n  let getter: any;\n\n  if (typeof source === 'function') {\n    getter = source;\n  } else if (isRef(source)) {\n    getter = () => source.value;\n  } else {\n    // ÊîØÊåÅ reactive ÂØπË±°\n    getter = () => traverse(source);\n  }\n\n  let oldValue: any;\n\n  // ÂÆö‰πâÂâØ‰ΩúÁî®ÂáΩÊï∞ÔºåËß¶ÂèëgetterËé∑ÂèñÂÄºÔºåÊâßË°åÂõûË∞É\n  function onEffect() {\n    const newValue = getter();\n    cb(newValue, oldValue);\n    oldValue = newValue;\n  }\n\n  // Ê≥®ÂÜåÂâØ‰ΩúÁî®ÂáΩÊï∞ÔºåÂìçÂ∫îÂºèÊï∞ÊçÆÂèòÂåñÊó∂Ëß¶Âèë\n  effect(onEffect);\n}\n\nfunction isRef(r: any) {\n  return r && typeof r === 'object' && r.__isRef;\n}\n\nfunction traverse(value: any, seen = new Set()) {\n  if (typeof value !== 'object' || value === null || seen.has(value)) return;\n\n  seen.add(value);\n\n  if (isRef(value)) {\n    // üëá ÈÄíÂΩíËÆøÈóÆ ref ÁöÑ .value\n    traverse(value.value, seen);\n  } else {\n    for (const key in value) {\n      traverse(value[key], seen);\n    }\n  }\n\n  return value;\n}\n\nexport { watch };\n","// ref.ts\nimport { track, trigger } from './dep';\n\nexport function ref<T>(rawValue: T) {\n  let value = rawValue;\n\n  return {\n    get value() {\n      track(this, 'value');\n      return value;\n    },\n    set value(newVal) {\n      if (newVal !== value) {\n        value = newVal;\n        trigger(this, 'value');\n      }\n    },\n    __isRef: true,\n  };\n}\n","// reactive.ts\nimport { track, trigger } from './dep';\n\nexport function reactive<T extends object>(target: T): T {\n  return new Proxy(target, {\n    get(obj, key, receiver) {\n      const res = Reflect.get(obj, key, receiver);\n      track(obj, key);\n      return typeof res === 'object' && res !== null ? reactive(res) : res;\n    },\n    set(obj: { [key: string | symbol]: any }, key, value, receiver) {\n      const oldVal = obj[key];\n      const res = Reflect.set(obj, key, value, receiver);\n      if (oldVal !== value) {\n        trigger(obj, key);\n      }\n      return res;\n    },\n  });\n}\n","// ËøêË°åÊó∂Ê®°Êãü defineProps (‰ªÖÊºîÁ§∫)\nexport function defineProps<T extends Record<string, any>>(options?: T): T {\n  // ÁºñËØëÊó∂‰ºöÊõøÊç¢Êàê props ÂèÇÊï∞\n  // ËøôÈáåÁÆÄÂåñ‰∏∫Áõ¥Êé•ËøîÂõû‰º†ÂÖ•ÂÆö‰πâÔºåÊ®°Êãü props Êï∞ÊçÆ\n  return options || ({} as T);\n}\n","import { deepClone, guid, isArray } from '@sugar/sugar-shared';\nimport { mountHandleList, updateActiveId } from '@sugar/sugar-hook';\nimport { bindT, VmDataRefPassive } from './index';\nimport { sugarCompiler } from '@sugar/sugar-compiler';\nimport patch from './patch';\nimport { addComponentCache, getComponentCache } from './componentCache';\nimport { effect, reactive } from '@sugar/sugar-reactive';\n\nexport function bulkComponent(_vnode: any, parentComponent: any) {\n  const {\n    data: { attrs, on },\n    children,\n  }: any = _vnode;\n\n  const _sugar: any = deepClone(parentComponent);\n  const props: any = reactive({});\n  const slot = children;\n  Object.keys(attrs).forEach((propName) => {\n    if (propName !== 'ref') {\n      props[propName] = attrs[propName];\n    }\n  });\n  Object.keys(on).forEach((propName) => {\n    if (on[propName].parameters) {\n      props[propName] = function () {\n        on[propName].value(...on[propName].parameters);\n      };\n    } else {\n      props[propName] = on[propName].value;\n    }\n  });\n  if (_vnode.key && getComponentCache(_vnode.key)) {\n    return getComponentCache(_vnode.key);\n  }\n  const app = makeComponent({\n    ..._sugar,\n    props,\n    slot,\n  });\n  app.mount();\n  _vnode.key && addComponentCache(app, _vnode.key);\n  return app;\n}\n\nexport function makeComponent(instance: any) {\n  const appId = guid();\n  updateActiveId(appId);\n  const data = instance.bulk(instance.props);\n  const { mounted, update } = componentRender();\n  const $: any = {};\n  const vm = {\n    render: instance.render,\n    _vnode: null,\n    data,\n    $el: null as any,\n    appId,\n    components: instance.components ? instance.components : [],\n    sugar: {},\n    slot: instance.slot,\n    props: instance.props,\n    headTag: instance.headTag || 'div',\n    use,\n    parent: instance.parent,\n  };\n\n  if (isArray(vm.components)) {\n    vm.components = vm.components.reduce((acc, cur) => {\n      acc[cur.name] = cur;\n      return acc;\n    }, {});\n  }\n\n  Object.values(data).forEach((d: any) => {\n    if (d.headTag && d.render && d.name && d.bulk) {\n      use(d);\n    }\n  });\n\n  function mount() {\n    mounted(vm, data);\n    mountHandleList[appId]?.forEach((item: any) => {\n      item.fun();\n      item.used = true;\n    });\n\n    effect(() => {\n      update(vm);\n    });\n  }\n\n  function forceUpdate() {\n    update(vm);\n  }\n\n  function updateSlot(slot: any) {\n    vm.slot = slot;\n    update(vm);\n  }\n\n  function use(components: any) {\n    if (!isArray(components)) {\n      components = [components];\n    }\n    components.forEach((component: any) => {\n      if (component.name) {\n        vm.components[component.name] = component;\n        vm.components[component.name].components = vm.components;\n      } else if (component.fun) {\n        $[component.fun] = component.bulk;\n      }\n    });\n  }\n\n  return {\n    vm,\n    mount,\n    ...data,\n    updateSlot,\n    forceUpdate,\n    use,\n    $,\n  };\n}\n\nexport function componentRender() {\n  let render: any = null;\n\n  function mounted(vm: any, data: any) {\n    vm.$el = document.createElement(vm.headTag);\n    vm._vnode = vm.$el;\n    render = vm.render;\n    bindT(vm, data);\n    vm.forceUpdate = function () {\n      update(vm);\n    };\n  }\n\n  function update(vm: any) {\n    const vmFiber: any = VmDataRefPassive(vm);\n    const vnode = render.call(VmDataRefPassive(vm));\n    vm.slot.length && assembling(vnode, vm.slot);\n    patch(vmFiber, vnode);\n    vmFiber._vnode = vnode;\n  }\n\n  function assembling(_n: any, slot: any) {\n    for (let i = 0; i < _n.children.length; i++) {\n      const child = _n.children[i];\n      if (child.tag === 'slot' && isDefault(slot) && child.data.attrs?.name === 'default') {\n        _n.children.splice(0, 1, ...slot);\n      } else if (child.tag === 'slot' && child.data.attrs?.name) {\n        const NamedSlot = slot.find((s: any) => {\n          return s.data?.attrs.slot === child.data.attrs.name;\n        });\n        updateSlot(child, NamedSlot, _n.children);\n      } else if (child.children?.length) {\n        assembling(child, slot);\n      }\n    }\n  }\n\n  function isDefault(slot: any) {\n    return !slot.find((s: any) => {\n      return !!s.data?.attrs.slot;\n    });\n  }\n\n  function updateSlot(oldSlot: any, newSlot: any, parent: any[]) {\n    if (!newSlot) {\n      parent.splice(parent.indexOf(oldSlot), 1, []);\n      return;\n    }\n    parent.splice(parent.indexOf(oldSlot), 1, ...newSlot.children);\n  }\n\n  return {\n    update,\n    mounted,\n  };\n}\n\nexport function Component(options: any) {\n  const { code, root } = sugarCompiler(options.render);\n  return {\n    ...options,\n    render: code,\n    headTag: root.tag,\n  };\n}\n","import { isDef, isUndef, nodeOps } from '@sugar/sugar-shared';\nimport { isComponent } from './utils';\nimport { bulkComponent } from './component';\n\nexport default function patch(vm: any, newVnode: any) {\n  let oldVnode = vm._vnode;\n  if (!oldVnode.elm) {\n    oldVnode = emptyNodeAt(oldVnode);\n  }\n  if (isSameNode(oldVnode, newVnode)) {\n    patchVnode(newVnode, oldVnode);\n  } else {\n    if (oldVnode.elm?.parentNode && newVnode) {\n      nodeOps.insert(\n        createElement(newVnode),\n        <Element>nodeOps.parentNode(oldVnode.elm),\n        oldVnode.elm,\n      );\n      nodeOps.remove(oldVnode.elm);\n    } else {\n      patchVnode(newVnode, oldVnode);\n    }\n  }\n\n  function createElement(vnode: any) {\n    let domNode;\n    if (vnode.tag) {\n      if (typeof vnode.tag === 'string' && !isComponent(vnode, vm.components)) {\n        if (vnode.tag === 'component' && vnode.data.attrs.is) {\n          const app = bulkComponent(vnode, vnode.data.attrs.is);\n          vnode.elm = app.vm.$el;\n          vnode._sugar = app;\n          domNode = vnode.elm;\n          if (vnode.data.attrs.ref && vnode.data.attrs.ref in vm) {\n            vm[vnode.data.attrs.ref] = app;\n          }\n        } else if (vnode.tag === 'svg' || vnode.tag === 'path') {\n          domNode = document.createElementNS('http://www.w3.org/2000/svg', vnode.tag);\n        } else {\n          domNode = document.createElement(vnode.tag);\n        }\n\n        const { data = {} } = vnode || {};\n\n        const { attrs = {}, on = {} } = data;\n        // Â§ÑÁêÜÂ±ûÊÄß\n        for (const key in attrs) {\n          if (Object.hasOwnProperty.call(attrs, key)) {\n            const value = attrs[key];\n            domNode.setAttribute(key, value);\n            if (key === 'ref' && value in vm) {\n              vm[value] = domNode;\n            }\n          }\n        }\n        const _vei = domNode._vei || (domNode._vei = {});\n        // Â§ÑÁêÜÁõëÂê¨‰∫ã‰ª∂\n        for (const key in on) {\n          if (Object.hasOwnProperty.call(on, key)) {\n            if (on[key].value) {\n              const event = (e: Event) => {\n                on[key].value(e);\n                if (on[key].modifiers.includes('stop')) {\n                  e.stopPropagation();\n                }\n                if (on[key].modifiers.includes('prevent')) {\n                  e.preventDefault();\n                }\n              };\n              domNode.addEventListener(key, event);\n              _vei[key] = event;\n            }\n          }\n        }\n        if (vnode.children) {\n          for (let i = 0; i < vnode.children.length; i++) {\n            const childrenDom = createElement(vnode.children[i]);\n            if (childrenDom) {\n              domNode.append(childrenDom);\n            }\n          }\n        }\n      } else if (isComponent(vnode, vm.components)) {\n        const app = bulkComponent(vnode, vm.components[getComponentName(vnode, vm)]);\n        vnode.elm = app.vm.$el;\n        vnode._sugar = app;\n        domNode = vnode.elm;\n        if (vnode.data.attrs.ref && vnode.data.attrs.ref in vm) {\n          vm[vnode.data.attrs.ref] = app;\n        }\n      }\n    } else if (vnode.text !== undefined) {\n      domNode = document.createTextNode(vnode.text);\n    } else if (vnode.elm !== undefined) {\n      domNode = vnode.elm;\n    }\n    vnode.elm = domNode;\n    return domNode;\n  }\n\n  function getComponentName(vnode: any, vm: any) {\n    if (vnode.tag === 'component') {\n      vm.use(vnode.data.attrs.is);\n      return vnode.data.attrs.is.name;\n    } else {\n      return vnode.tag;\n    }\n  }\n\n  function patchVnode(newVnode: any, oldVnode: any) {\n    if (isComponent(newVnode, vm.components)) {\n      if (!oldVnode._sugar) {\n        const node = createElement(newVnode);\n        nodeOps.insert(node, <Element>nodeOps.parentNode(oldVnode.elm), oldVnode.elm);\n        oldVnode.elm.remove();\n        oldVnode.elm = node;\n      } else {\n        updateComponent(newVnode, oldVnode);\n        bindComponentInstance(newVnode, vm);\n      }\n      return;\n    }\n    newVnode.elm = oldVnode.elm;\n    if (newVnode.text !== undefined) {\n      if (oldVnode.text !== newVnode.text) {\n        oldVnode.elm.nodeValue = newVnode.text;\n      }\n    } else if (newVnode.tag) {\n      patchProps(newVnode, oldVnode, vm);\n      if (oldVnode.children?.length) {\n        updateChildren(oldVnode.elm, oldVnode.children, newVnode.children);\n      } else if (newVnode.children.length > 0) {\n        oldVnode.elm.innerHTML = '';\n        for (let i = 0; i < newVnode.children.length; i++) {\n          const child = createElement(newVnode.children[i]);\n          if (child) {\n            oldVnode.elm.appendChild(child);\n          }\n        }\n      }\n    }\n  }\n\n  function patchProps(newVnode: any, oldVnode: any, vm: any) {\n    const attrs = newVnode.data.attrs;\n    const on = newVnode.data.on;\n    const oldAttrs = oldVnode.data.attrs;\n    const elm = newVnode.elm;\n    patchAttrs(elm, oldAttrs, attrs, vm);\n    patchEvents(elm, on);\n  }\n\n  function patchAttrs(el: any, oldAttrs: any, newAttrs: any, vm: any) {\n    if (oldAttrs) {\n      Object.keys(oldAttrs).forEach((attr) => {\n        if (newAttrs[attr] !== oldAttrs[attr]) {\n          el.removeAttribute(attr);\n        }\n      });\n    }\n\n    Object.keys(newAttrs).forEach((attr) => {\n      if (attr === 'value') {\n        el.value = newAttrs[attr];\n      }\n      if (!oldAttrs || newAttrs[attr] !== oldAttrs[attr]) {\n        el.setAttribute(attr, newAttrs[attr]);\n      }\n\n      if (attr === 'ref' && newAttrs[attr] in vm) {\n        vm[newAttrs[attr]] = el;\n      }\n    });\n  }\n\n  function updateChildren(parentDom: any, oldCh: any, newCh: any) {\n    oldCh = clearEmptyVnode(oldCh);\n    newCh = clearEmptyVnode(newCh);\n\n    // ÊóßÂâç\n    let oldPreIndex = 0;\n    // ÊóßÂêé\n    let oldAftIndex = oldCh.length - 1;\n    // Êñ∞Ââç\n    let newPreIndex = 0;\n    // Êñ∞Âêé\n    let newAftIndex = newCh.length - 1;\n    // ÊóßÂâçËäÇÁÇπ\n    let oldSNode = oldCh[oldPreIndex];\n    // ÊóßÂêéËäÇÁÇπ\n    let oldENode = oldCh[oldAftIndex];\n    // Êñ∞ÂâçËäÇÁÇπ\n    let newSNode = newCh[newPreIndex];\n    // Êñ∞ÂêéËäÇÁÇπ\n    let newENode = newCh[newAftIndex];\n\n    let oldKeyToIdx, idxInOld, elmToMove, refElm;\n\n    while (oldPreIndex <= oldAftIndex && newPreIndex <= newAftIndex) {\n      if (!oldSNode || !oldCh[oldPreIndex]) {\n        oldSNode = oldCh[++oldPreIndex];\n      } else if (!oldENode || !oldCh[oldAftIndex]) {\n        oldENode = oldCh[--oldAftIndex];\n      } else if (!newSNode || !newCh[newPreIndex]) {\n        newSNode = newCh[++newPreIndex];\n      } else if (!newENode || !newCh[newAftIndex]) {\n        newENode = newCh[--newAftIndex];\n      } else if (isSameNode(newSNode, oldSNode)) {\n        patchVnode(newSNode, oldSNode);\n        oldSNode = oldCh[++oldPreIndex];\n        newSNode = newCh[++newPreIndex];\n        // Êñ∞Ââç‰∏éÊóßÂêé\n      } else if (isSameNode(newSNode, oldENode)) {\n        patchVnode(newSNode, oldENode);\n        parentDom.insertBefore(oldENode.elm, oldSNode.elm);\n        oldENode = oldCh[--oldAftIndex];\n        newSNode = newCh[++newPreIndex];\n        // Êñ∞Âêé‰∏éÊóßÂâç\n      } else if (isSameNode(newENode, oldSNode)) {\n        patchVnode(newENode, oldSNode);\n        parentDom.insertBefore(oldSNode.elm, oldENode.elm.nextSibling);\n        oldSNode = oldCh[++oldPreIndex];\n        newENode = newCh[--newAftIndex];\n        // Êñ∞Âêé‰∏éÊóßÂêé\n      } else if (isSameNode(newENode, oldENode)) {\n        patchVnode(newENode, oldENode);\n        oldENode = oldCh[--oldAftIndex];\n        newENode = newCh[--newAftIndex];\n      } else {\n        if (isUndef(oldKeyToIdx)) oldKeyToIdx = createKeyToOldIdx(oldCh, oldPreIndex, oldAftIndex);\n        idxInOld = isDef(newSNode.key) ? oldKeyToIdx[newSNode.key] : null;\n        if (isUndef(idxInOld)) {\n          parentDom.insertBefore(createElement(newSNode), oldSNode.elm);\n          newSNode = newCh[++newPreIndex];\n        } else {\n          elmToMove = oldCh[idxInOld];\n          if (isSameNode(elmToMove, newSNode)) {\n            patchVnode(newSNode, elmToMove);\n            oldCh[idxInOld] = undefined;\n            parentDom.insertBefore(elmToMove.elm, oldSNode.elm);\n          } else {\n            parentDom.insertBefore(createElement(newSNode), oldSNode.elm);\n          }\n\n          newSNode = newCh[++newPreIndex];\n        }\n      }\n    }\n\n    if (oldPreIndex > oldAftIndex) {\n      refElm = isUndef(newCh[newAftIndex + 1]) ? null : newCh[newAftIndex + 1].elm;\n      for (; newPreIndex <= newAftIndex; newPreIndex++) {\n        if (refElm) {\n          parentDom.insertBefore(createElement(newCh[newPreIndex]), refElm);\n        } else {\n          parentDom.append(createElement(newCh[newPreIndex]));\n        }\n      }\n    }\n\n    if (newPreIndex > newAftIndex) {\n      for (let i = oldPreIndex; i <= oldAftIndex; i++) {\n        if (oldCh[i]?.elm) {\n          parentDom.removeChild(oldCh[i].elm);\n        }\n      }\n    }\n  }\n\n  function createKeyToOldIdx(children: any, beginIdx: any, endIdx: any) {\n    let i, key;\n    const map: any = {};\n    for (i = beginIdx; i <= endIdx; ++i) {\n      key = children[i].key;\n      if (isDef(key)) map[key] = i;\n    }\n    return map;\n  }\n}\n\nexport function updateComponent(newVnode: any, oldVnode: any) {\n  Object.keys(oldVnode._sugar.vm.props).forEach((prop) => {\n    const { attrs, on } = newVnode.data;\n    if (Object.keys(attrs).includes(prop)) {\n      oldVnode._sugar.vm.props[prop] = newVnode.data.attrs[prop];\n    } else if (Object.keys(on).includes(prop)) {\n      if (newVnode.data.on[prop].parameters) {\n        oldVnode._sugar.vm.props[prop] = function () {\n          newVnode.data.on[prop].value(...newVnode.data.on[prop].parameters);\n        };\n      } else {\n        oldVnode._sugar.vm.props[prop] = newVnode.data.on[prop].value;\n      }\n    }\n  });\n  oldVnode._sugar.updateSlot(newVnode.children);\n  newVnode.elm = oldVnode.elm;\n  newVnode._sugar = oldVnode._sugar;\n}\n\nexport function emptyNodeAt(elm: any) {\n  return new VNode(elm.tagName.toLowerCase(), {}, [], elm);\n}\n\nfunction isSameNode(o: any, n: any) {\n  return o.key === n.key && o.tag === n.tag;\n}\n\nfunction patchEvents(el: any, newOn: any) {\n  const _vei = el._vei || (el._vei = {});\n  Object.keys(_vei).forEach((eventName) => {\n    el.removeEventListener(eventName, _vei[eventName]);\n  });\n  Object.keys(newOn).forEach((eventName) => {\n    _vei[eventName] = (e: Event) => {\n      if (newOn[eventName].modifiers.includes('stop')) {\n        e.stopPropagation();\n      }\n      if (newOn[eventName].modifiers.includes('prevent')) {\n        e.preventDefault();\n      }\n      newOn[eventName].value(e);\n    };\n    el.addEventListener(eventName, _vei[eventName]);\n  });\n}\n\nfunction clearEmptyVnode(Vnodes: any) {\n  return Vnodes.filter((Vnode: any) => {\n    return Vnode.tag || Vnode.text === '' || Vnode.text || Vnode.elm;\n  });\n}\n\nfunction bindComponentInstance(vNode: any, vm: any) {\n  const data = vNode.data;\n  if (data) {\n    const attrs = data.attrs;\n    if (attrs.ref && vm[attrs.ref] in vm) {\n      vm[attrs.ref] = vNode.elm;\n    }\n  }\n  if (vNode.children) {\n    vNode.children.forEach((child: any) => {\n      bindComponentInstance(child, vm);\n    });\n  }\n}\n\nclass VNode {\n  private readonly tag: any;\n  private readonly data: any;\n  private readonly elm: undefined;\n  private readonly context: undefined;\n  private readonly text: undefined;\n  private readonly key: undefined;\n  private readonly _sugar: undefined;\n\n  constructor(tag?: any, data?: any, children?: any, elm?: any) {\n    this.tag = tag;\n    this.data = data;\n    // @ts-expect-error\n    this.children = children;\n    this.key = data.attrs?.key;\n    this.elm = elm;\n    this.context = undefined;\n    this.text = undefined;\n  }\n}\n","import { sugarCompiler } from '@sugar/sugar-compiler';\nimport patch from './patch';\nimport { escape2Html } from '@sugar/sugar-shared';\n\nimport { Component } from './component';\nimport { effect } from '@sugar/sugar-reactive';\n\nexport { Component };\n\nexport function sugarRender() {\n  let render: Function | null = null;\n\n  function mounted<T>(vm: any, data: T) {\n    const serializer = new XMLSerializer();\n    if (!vm.render) {\n      const htmlCode = vm.render ? vm.render : escape2Html(serializer.serializeToString(vm.$el));\n      const { code } = sugarCompiler(htmlCode);\n      render = code;\n    } else {\n      render = vm.render;\n    }\n    bindT(vm, data);\n    effect(() => {\n      update(vm);\n    });\n  }\n\n  function update(vm: any) {\n    const vmFiber: any = VmDataRefPassive(vm);\n    const vnode = render?.call(vmFiber);\n    patch(vmFiber, vnode);\n    vmFiber._vnode = vnode;\n  }\n\n  return {\n    update,\n    mounted,\n  };\n}\n\nexport function VmDataRefPassive(vm: any) {\n  return new Proxy(vm, {\n    get(target, prop, receiver) {\n      const val = Reflect.get(target, prop, receiver);\n      if (isRef(val)) {\n        return val.value;\n      } else {\n        return val;\n      }\n    },\n    set(target, prop, newValue, receiver) {\n      const val = Reflect.get(target, prop, receiver);\n      if (isRef(val)) {\n        val.value = newValue;\n      } else {\n        Reflect.set(target, prop, newValue);\n      }\n      return true;\n    },\n  });\n}\n\nfunction isRef(value: any) {\n  return !!value?.__isRef;\n}\n\nexport function bindT(vm: any, data: any) {\n  Object.keys(data).forEach((key) => {\n    vm[key] = data[key];\n  });\n\n  function _c(tag = 'div', data = {}, children = []) {\n    return createElement(tag, data, children);\n  }\n\n  function _v(str: string) {\n    const vnode: any = new VNode();\n    vnode.text = str;\n    return vnode;\n  }\n\n  function _s(val: string) {\n    return String(val);\n  }\n\n  function _e() {\n    return {\n      tag: 'div',\n      data: {\n        attrs: {\n          class: 's-block',\n        },\n        on: {},\n      },\n      children: [],\n      elm: {\n        _vei: {},\n      },\n    };\n  }\n\n  function _html(html: string) {\n    return html2Vnode(html);\n  }\n\n  function _loop(fun: Function, data: any) {\n    const nodes: any[] = [];\n    data.forEach((item: any, index: number) => {\n      nodes.push({\n        ...fun(item, index),\n      });\n    });\n    return nodes;\n  }\n\n  vm._SUGAR = {\n    _c,\n    _v,\n    _s,\n    _e,\n    _loop,\n    _html,\n  };\n}\n\nexport function createElement(tag = 'div', data = {}, children = []) {\n  const createVNode = (tag = 'div', data = {}, children = []) => {\n    const vnodeChildren: any[] = [];\n\n    if (children && children.length > 0) {\n      children.forEach((child) => {\n        vnodeChildren.push(child);\n      });\n    }\n    return new VNode(tag, data, vnodeChildren);\n  };\n\n  // renderÂáΩÊï∞‰∏≠ÊâßË°å_cÔºåÊé•Êî∂ÂèÇÊï∞ÔºåÂàõÂª∫vnode\n  return createVNode(tag, data, children);\n}\n\nexport class VNode {\n  private readonly tag: any;\n  private readonly data: any;\n  private readonly elm: undefined;\n  private readonly context: undefined;\n  private readonly text: undefined;\n  private readonly key: undefined;\n  private readonly sugar: any;\n\n  constructor(\n    tag?: string | undefined,\n    data?: { attrs?: any } | undefined,\n    children?: any[] | undefined,\n  ) {\n    this.tag = tag;\n    this.data = data;\n    // @ts-expect-error\n    this.children = children;\n    this.elm = undefined;\n    this.context = undefined;\n    this.text = undefined;\n    this.key = data?.attrs?.key;\n  }\n}\n\nexport function html2Vnode(html: string) {\n  function work(dom: any) {\n    const attr = {\n      attrs: {} as any,\n      on: {},\n    };\n    Array.from(dom.attributes).forEach((item: any) => {\n      attr.attrs[item.name] = item.value;\n    });\n    const vNode: any = createElement(dom.tagName, attr, []);\n    Array.from(dom.childNodes).forEach((child: any) => {\n      if (child.nodeType === 1) {\n        vNode.children.push(work(child));\n      } else if (child.nodeType === 3) {\n        vNode.children.push({\n          tag: '',\n          content: child.textContent,\n          children: [],\n          elm: undefined,\n          text: child.textContent,\n          key: undefined,\n          data: undefined,\n        });\n      }\n    });\n    return vNode;\n  }\n\n  const div = document.createElement('div');\n  div.innerHTML = html;\n  return work(div);\n}\n","import { addCSS } from '@sugar/sugar-shared';\n\nexport function initCSS() {\n  addCSS(`\n      .s-block{\n        display:none;\n      }\n  \n      .s-loading{\n        position: absolute;\n        background: rgba(255,255,255,0.8);\n        z-index: 99999;\n        left: 0;\n        top: 0;\n        width: 100%;\n        height: 100%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n      }\n      \n      .s-loading svg{\n        animation: sLoading 1s linear infinite;\n      }\n  \n      @keyframes sLoading {\n        from {\n          transform: rotate(0deg);\n        }\n        to {\n          transform: rotate(360deg);\n        }\n      }\n  \n  `);\n}\n","import { type Core } from './types';\nimport { onMounted, mountHandleList, updateActiveId } from '@sugar/sugar-hook';\nimport { sugarRender } from '@sugar/sugar-render';\nimport { guid, isArray } from '@sugar/sugar-shared';\nimport { nextTick } from '@sugar/sugar-reactive';\nimport { initCSS } from './utils/utils';\n\nfunction createApp(options: Core) {\n  const appId = guid();\n  updateActiveId(appId);\n  const data = options.bulk(options.props);\n  const $: any = {};\n  const { mounted } = sugarRender();\n  const vm = {\n    render: options.render,\n    _vnode: null,\n    data,\n    $el: null as any,\n    appId,\n    components: (options.components || []) as any,\n    sugar: {},\n    slot: options.slot,\n    forceUpdate: () => {},\n    use,\n  };\n\n  if (isArray(vm.components)) {\n    vm.components = vm.components.reduce((acc, cur) => {\n      acc[cur.name] = cur;\n      return acc;\n    }, {});\n  }\n\n  function mount(el: string | HTMLElement) {\n    initCSS();\n    vm._vnode = vm.$el = typeof el === 'string' ? document.querySelector(`${el}`) : el;\n    mounted(vm, data);\n    void nextTick(() => {\n      mountHandleList[appId]?.forEach((item: any) => {\n        item.fun();\n        item.used = true;\n      });\n    });\n  }\n\n  function use(components: any) {\n    if (!isArray(components)) {\n      components = [components];\n    }\n    components.forEach((component: any) => {\n      if (component.name) {\n        vm.components[component.name] = component;\n        vm.components[component.name].components = vm.components;\n      } else if (component.fun) {\n        $[component.fun] = component.bulk;\n      }\n    });\n    vm.$el && vm.forceUpdate();\n  }\n\n  return {\n    vm,\n    mount,\n    ...data,\n    use,\n    $,\n  };\n}\n\nexport { createApp, onMounted, updateActiveId, mountHandleList };\n","import { createApp, onMounted } from '@sugar/sugar-core';\nimport { nextTick, ref, reactive, watch, defineProps } from '@sugar/sugar-reactive';\nimport { Component } from '@sugar/sugar-render';\nimport { sugarCompiler } from '@sugar/sugar-compiler';\n\nif (typeof window !== 'undefined') {\n  (function (global: any) {\n    global.SUGAR = {\n      onMounted,\n      createApp,\n      nextTick,\n      ref,\n      Component,\n      reactive,\n      watch,\n      defineProps,\n    };\n  })(window);\n}\n\nexport {\n  createApp,\n  onMounted,\n  nextTick,\n  ref,\n  Component,\n  reactive,\n  watch,\n  sugarCompiler,\n  defineProps,\n};\n"],"names":["mountHandleList","ActiveId","onMounted","handle","updateActiveId","id","isArray","extend","isSimpleIdentifier","exp","isStaticExpression","dynamicKeywords","keyword","scopeStack","enterScope","newScope","exitScope","parse","context","ancestors","parent","last","nodes","isEnd","node","startsWith","parseInterpolation","advanceBy","parseTag","parseComment","parseElement","parseText","i","pushNode","removedWhitespace","shouldCondense","prev","next","first","parseAttributes","type","props","attributeNames","firstTagMatch","aliases","advanceSpaces","attr","parseAttribute","bindCtx","tar","nameSet","start","getPos","name","value","parseAttributeValue","loc","getSelection","match","isPropShorthand","dirName","arg","isSlot","startOffset","getNewPosition","content","valueLoc","advancePosWithClone","modifiers","numberOfCharacters","quote","isQuoted","endIndex","parseTextData","element","children","startsWithEndTagOpen","tag","isSelfClosing","Namespaces","contentStart","closeIndex","s","open","close","innerStart","innerEnd","rawContentLength","rawContent","preTrimContent","matchText","advancePos","endOffset","endTokens","index","length","rawText","end","source","pos","linesCount","lastNewLinePos","searchString","xs","column","line","offset","NodeTypes","jsGlobals","code","varName","fullText","before","inSingleQuotes","inDoubleQuotes","inBacktick","prevChar","hasScope","flattenArray","arr","result","item","NO","toAst","template","createBaseContent","nodeOps","child","anchor","val","isDef","v","isUndef","escape2Html","str","arrEntities","all","t","p1","is","deepClone","weakMap","strict","newSet","newMap","newArr","newObj","key","symbolKeys","sKey","guid","c","r","addCSS","cssText","style","head","func","textNode","transform","helpers","work","prop","sIf","generate","ast","genElmChildren","getElm","elStr","ex","dealAttr","dealEvent","transformFor","loadingRender","createElementString","forStatment","elementStr","funString","Array2String","a","sFor","forMatch","reg","sHtml","sLoading","transformEvent","eventStr","sModel","baseCompile","sugarCompiler","compile","root","createFunction","isComponent","vnode","components","componentCache","addComponentCache","sugar","getComponentCache","callbacks","pending","flushCallbacks","copies","nextTick","cb","_resolve","resolve","reject","jobQueue","isFlushing","queueJob","job","targetMap","activeEffect","effect","fn","wrapper","track","target","depsMap","deps","trigger","effects","watch","getter","isRef","traverse","oldValue","onEffect","newValue","seen","ref","rawValue","newVal","reactive","obj","receiver","res","oldVal","defineProps","options","bulkComponent","_vnode","parentComponent","attrs","on","_sugar","slot","propName","app","makeComponent","instance","appId","data","mounted","update","componentRender","$","vm","use","acc","cur","d","mount","forceUpdate","updateSlot","component","render","bindT","vmFiber","VmDataRefPassive","assembling","patch","_n","isDefault","NamedSlot","oldSlot","newSlot","Component","newVnode","oldVnode","emptyNodeAt","isSameNode","patchVnode","createElement","domNode","_vei","event","e","childrenDom","getComponentName","updateComponent","bindComponentInstance","patchProps","updateChildren","oldAttrs","elm","patchAttrs","patchEvents","el","newAttrs","parentDom","oldCh","newCh","clearEmptyVnode","oldPreIndex","oldAftIndex","newPreIndex","newAftIndex","oldSNode","oldENode","newSNode","newENode","oldKeyToIdx","idxInOld","elmToMove","refElm","createKeyToOldIdx","beginIdx","endIdx","map","VNode","o","n","newOn","eventName","Vnodes","Vnode","vNode","VNode$1","sugarRender","serializer","htmlCode","_c","_v","_s","_e","_html","html","html2Vnode","_loop","fun","vnodeChildren","dom","div","initCSS","createApp","global"],"mappings":"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"}